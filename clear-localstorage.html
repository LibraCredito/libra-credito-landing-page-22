<!DOCTYPE html>
<html>
<head>
    <link rel="preconnect" href="https://www.googletagmanager.com" crossorigin>
    <!-- Google Tag Manager (loaded after first paint or on user interaction) -->
    <script>
        function loadGTM(){
            if (window.gtmLoaded) return;
            window.gtmLoaded = true;
            (function(w,d,s,l,i){
                w[l]=w[l]||[];
                w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});
                var f=d.getElementsByTagName(s)[0],
                    j=d.createElement(s),
                    dl=l!='dataLayer'?'&l='+l:'';
                j.async=true;
                j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;
                f.parentNode.insertBefore(j,f);
            })(window,document,'script','dataLayer','GTM-M943GMK8');
        }
        if (window.requestIdleCallback) {
            requestIdleCallback(loadGTM);
        } else {
            setTimeout(loadGTM, 0);
        }
        ['scroll','mousemove','touchstart','keydown'].forEach(function(evt){
            window.addEventListener(evt, loadGTM, { once: true });
        });
    </script>
    <!-- End Google Tag Manager -->
    <title>Limpar LocalStorage</title>
</head>
<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript>
        <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-M943GMK8" height="0" width="0" style="display:none;visibility:hidden"></iframe>
    </noscript>
    <!-- End Google Tag Manager (noscript) -->
    <h1>Limpando LocalStorage...</h1>
    <div id="status">Processando...</div>
    
    <script>
        // Limpar todos os dados do localStorage relacionados ao projeto
        const keysToRemove = [
            'libra_blog_posts',
            'libra_blog_images', 
            'libra_session_id',
            'libra_user_journey',
            'libra_simulation_config',
            'libra_admin_token',
            'libra_admin_user'
        ];
        
        let removedCount = 0;
        
        keysToRemove.forEach(key => {
            if (localStorage.getItem(key)) {
                localStorage.removeItem(key);
                removedCount++;
                console.log(`Removido: ${key}`);
            }
        });
        
        // Limpar também qualquer chave que comece com 'libra'
        const allKeys = Object.keys(localStorage);
        allKeys.forEach(key => {
            if (key.startsWith('libra') || key.startsWith('sb-')) {
                localStorage.removeItem(key);
                removedCount++;
                console.log(`Removido: ${key}`);
            }
        });
        
        document.getElementById('status').innerHTML = `
            <h2>✅ LocalStorage Limpo!</h2>
            <p>Removidas ${removedCount} entradas</p>
            <p>Recarregue a página principal e teste novamente.</p>
            <button onclick="window.close()">Fechar</button>
        `;
        
        console.log(`LocalStorage limpo! ${removedCount} itens removidos.`);
    </script>
</body>
</html>
